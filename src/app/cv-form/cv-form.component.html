<!-- Navigation Bar -->
<div class="fixed top-0 left-0 right-0 bg-white shadow-sm border-b border-gray-200 z-10">
  <div class="max-w-5xl mx-auto px-4 sm:px-6 lg:px-8">
    <div class="flex items-center justify-between h-16">
      <!-- Left side - Home button -->
      <div>
        <button type="button" (click)="router.navigate(['/'])"
                class="inline-flex items-center px-4 py-2 text-gray-700 hover:text-blue-600">
          <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor">
            <path d="M10.707 2.293a1 1 0 00-1.414 0l-7 7a1 1 0 001.414 1.414L4 10.414V17a1 1 0 001 1h2a1 1 0 001-1v-2a1 1 0 011-1h2a1 1 0 011 1v2a1 1 0 001 1h2a1 1 0 001-1v-6.586l.293.293a1 1 0 001.414-1.414l-7-7z" />
          </svg>
          <span class="ml-2">Home</span>
        </button>
      </div>

      <!-- Right side - Action buttons -->
      <!-- Desktop buttons (hidden on small screens) -->
      <div class="hidden sm:flex items-center space-x-4">
        <!-- Import JSON -->
        <button type="button"
                (click)="onUploadClick()"
                class="inline-flex items-center px-4 py-2 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500">
          <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2" viewBox="0 0 20 20" fill="currentColor">
            <path fill-rule="evenodd" d="M3 17a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM6.293 6.707a1 1 0 010-1.414l3-3a1 1 0 011.414 0l3 3a1 1 0 01-1.414 1.414L11 5.414V13a1 1 0 11-2 0V5.414L7.707 6.707a1 1 0 01-1.414 0z" clip-rule="evenodd" />
          </svg>
          Import JSON
        </button>

        <!-- Export JSON -->
        <button type="button"
                (click)="exportJSON()"
                class="inline-flex items-center px-4 py-2 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500">
          <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2" viewBox="0 0 20 20" fill="currentColor">
            <path fill-rule="evenodd" d="M3 17a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM6.293 6.707a1 1 0 010-1.414l3-3a1 1 0 011.414 0l3 3a1 1 0 01-1.414 1.414L11 5.414V13a1 1 0 11-2 0V5.414L7.707 6.707a1 1 0 01-1.414 0z" clip-rule="evenodd" transform="rotate(180 10 10)" />
          </svg>
          Export JSON
        </button>

        <!-- Generate CV -->
        <button type="button"
                (click)="generateCV()"
                class="inline-flex items-center px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500">
          <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2" viewBox="0 0 20 20" fill="currentColor">
            <path fill-rule="evenodd" d="M6 2a2 2 0 00-2 2v12a2 2 0 002 2h8a2 2 0 002-2V7.414A2 2 0 0015.414 6L12 2.586A2 2 0 0010.586 2H6zm5 6a1 1 0 10-2 0v3.586L7.707 10.293a1 1 0 10-1.414 1.414l3 3a1 1 0 001.414 0l3-3a1 1 0 00-1.414-1.414L11 11.586V8z" clip-rule="evenodd" />
          </svg>
          Generate CV
        </button>
      </div>

      <!-- Mobile menu button (visible only on small screens) -->
      <div class="sm:hidden">
        <div class="relative">
          <button type="button" 
                  (click)="toggleMobileMenu()" 
                  class="inline-flex items-center justify-center p-2 rounded-md text-gray-700 hover:text-blue-600 hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-inset focus:ring-blue-500">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16" />
            </svg>
          </button>
          
          <!-- Mobile menu dropdown -->
          <div *ngIf="showMobileMenu" 
               class="origin-top-right absolute right-0 mt-2 w-48 rounded-md shadow-lg bg-white ring-1 ring-black ring-opacity-5 focus:outline-none z-20">
            <div class="py-1">
              <button type="button"
                      (click)="onUploadClick(); toggleMobileMenu()"
                      class="w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 hover:text-gray-900">
                Import JSON
              </button>
              <button type="button"
                      (click)="exportJSON(); toggleMobileMenu()"
                      class="w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 hover:text-gray-900">
                Export JSON
              </button>
              <button type="button"
                      (click)="generateCV(); toggleMobileMenu()"
                      class="w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 hover:text-gray-900">
                Generate CV
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Main Container - Adjusted with top padding for the fixed navbar -->
<div class="min-h-screen bg-gray-50 pt-24 pb-8">
  <div class="max-w-5xl mx-auto px-4 sm:px-6 lg:px-8">
    <form [formGroup]="cvForm" (ngSubmit)="generateCV()" class="space-y-8">
      
      <!-- Personal Information -->
      <div class="bg-white rounded-xl shadow-sm p-6">
        <h2 class="text-xl font-semibold text-gray-900 mb-6">Personal Information</h2>
        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-1">Full Name</label>
            <input type="text" formControlName="name"
                   class="w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
                   [ngClass]="{'border-red-500': isFieldInvalid('name'), 'border-gray-300': !isFieldInvalid('name')}">
            <p *ngIf="isFieldInvalid('name')" class="mt-1 text-sm text-red-600">
              {{getErrorMessage('name')}}
            </p>
          </div>

          <div>
            <label class="block text-sm font-medium text-gray-700 mb-1">Title</label>
            <input type="text" formControlName="title"
                   class="w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
                   [ngClass]="{'border-red-500': isFieldInvalid('title'), 'border-gray-300': !isFieldInvalid('title')}">
            <p *ngIf="isFieldInvalid('title')" class="mt-1 text-sm text-red-600">
              {{getErrorMessage('title')}}
            </p>
          </div>

          <div>
            <label class="block text-sm font-medium text-gray-700 mb-1">Email</label>
            <input type="email" formControlName="email"
                   class="w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
                   [ngClass]="{'border-red-500': isFieldInvalid('email'), 'border-gray-300': !isFieldInvalid('email')}">
            <p *ngIf="isFieldInvalid('email')" class="mt-1 text-sm text-red-600">
              {{getErrorMessage('email')}}
            </p>
          </div>

          <div>
            <label class="block text-sm font-medium text-gray-700 mb-1">Phone</label>
            <input type="tel" formControlName="phone"
                   class="w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
                   [ngClass]="{'border-red-500': isFieldInvalid('phone'), 'border-gray-300': !isFieldInvalid('phone')}">
            <p *ngIf="isFieldInvalid('phone')" class="mt-1 text-sm text-red-600">
              {{getErrorMessage('phone')}}
            </p>
          </div>

          <div class="md:col-span-2">
            <label class="block text-sm font-medium text-gray-700 mb-1">Brief Profile</label>
            <textarea formControlName="briefProfile" rows="3"
                      class="w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 resize-y min-h-[100px]"
                      [ngClass]="{'border-red-500': isFieldInvalid('briefProfile'), 'border-gray-300': !isFieldInvalid('briefProfile')}"></textarea>
            <p *ngIf="isFieldInvalid('briefProfile')" class="mt-1 text-sm text-red-600">
              {{getErrorMessage('briefProfile')}}
            </p>
          </div>
        </div>
      </div>

      <!-- Skills -->
      <div class="bg-white rounded-xl shadow-sm p-6">
        <h2 class="text-xl font-semibold text-gray-900 mb-6">Skills</h2>
        
        <!-- Add New Category -->
        <div class="mb-6">
          <label class="block text-sm font-medium text-gray-700 mb-1">Add New Category</label>
          <div class="flex gap-2">
            <input type="text" 
                   placeholder="Enter category name..." 
                   #categoryInput
                   class="flex-1 px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
                   (keydown.enter)="addSkillCategory({value: categoryInput.value, chipInput: categoryInput}); $event.preventDefault()">
            <button type="button"
                    (click)="addSkillCategory({value: categoryInput.value, chipInput: categoryInput})"
                    class="px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700">
              Add Category
            </button>
          </div>
        </div>

        <!-- Skills Categories -->
        <div class="space-y-6">
          <div *ngFor="let category of getSkillCategories()" class="bg-gray-50 rounded-lg p-4">
            <div class="flex justify-between items-center mb-3">
              <h3 class="text-lg font-medium text-gray-900">{{category}}</h3>
              <button type="button" 
                      (click)="removeSkillCategory(category)"
                      class="text-red-600 hover:text-red-700">
                <span class="text-xl">×</span>
              </button>
            </div>

            <!-- Skills in Category -->
            <div class="space-y-3">
              <div class="flex flex-wrap gap-2">
                <ng-container *ngIf="getSkillsForCategory(category) as skills">
                  <span *ngFor="let skill of skills; let si = index" 
                        class="px-3 py-1 bg-blue-50 text-blue-700 rounded-full text-sm flex items-center">
                    {{skill}}
                    <button type="button" 
                            (click)="removeSkill(si, category)" 
                            class="ml-2 text-blue-500 hover:text-blue-700">×</button>
                  </span>
                </ng-container>
              </div>
              
              <div class="flex gap-2">
                <input type="text" 
                       [placeholder]="'Add skill to ' + category + '...'" 
                       #skillInput
                       class="flex-1 px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
                       (keydown.enter)="addSkill({value: skillInput.value, chipInput: skillInput}, category); $event.preventDefault()">
                <button type="button"
                        (click)="addSkill({value: skillInput.value, chipInput: skillInput}, category)"
                        class="px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700">
                  Add Skill
                </button>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Work Experience -->
      <div class="bg-white rounded-xl shadow-sm p-6">
        <div class="flex items-center justify-between mb-6">
          <h2 class="text-xl font-semibold text-gray-900">Work Experience</h2>
          <button type="button" (click)="addWorkExperience()"
                  class="px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 flex items-center">
            <span class="mr-2">+</span> Add Experience
          </button>
        </div>

        <div formArrayName="workExperiences" class="space-y-6">
          <div *ngFor="let exp of workExperiencesArray.controls; let i = index" 
               [formGroupName]="i"
               class="p-6 bg-gray-50 rounded-lg border border-gray-200">
            <div class="flex justify-between items-center mb-4">
              <h3 class="text-lg font-medium text-gray-900">Experience {{i + 1}}</h3>
              <button type="button" (click)="removeWorkExperience(i)"
                      class="text-red-600 hover:text-red-700 p-1">
                <span class="text-xl">×</span>
              </button>
            </div>

            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
              <div>
                <label class="block text-sm font-medium text-gray-700 mb-1">Company</label>
                <input type="text" formControlName="company"
                       class="w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
                       [ngClass]="{'border-red-500': isFieldInvalid('workExperiences.' + i + '.company')}">
                <p *ngIf="isFieldInvalid('workExperiences.' + i + '.company')" class="mt-1 text-sm text-red-600">
                  Company name is required
                </p>
              </div>

              <div>
                <label class="block text-sm font-medium text-gray-700 mb-1">Position</label>
                <input type="text" formControlName="position"
                       class="w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
                       [ngClass]="{'border-red-500': isFieldInvalid('workExperiences.' + i + '.position')}">
                <p *ngIf="isFieldInvalid('workExperiences.' + i + '.position')" class="mt-1 text-sm text-red-600">
                  Position is required
                </p>
              </div>

              <!-- Work Experience Date Inputs -->
              <div>
                <app-month-year-picker
                  label="Start Date"
                  [yearRange]="'1980:2030'"
                  [invalid]="isFieldInvalid('workExperiences.' + i + '.startDate')"
                  [errorMessage]="'Start date is required'"
                  [dateValue]="exp.get('startDate')?.value"
                  (dateChange)="handleDateChange(exp.get('startDate'), $event)">
                </app-month-year-picker>
              </div>

              <div>
                <app-month-year-picker
                  label="End Date"
                  [yearRange]="'1980:2030'"
                  [invalid]="isFieldInvalid('workExperiences.' + i + '.endDate')"
                  [errorMessage]="'End date is required'"
                  [allowPresent]="true"
                  [dateValue]="exp.get('endDate')?.value"
                  (dateChange)="handleDateChange(exp.get('endDate'), $event)">
                </app-month-year-picker>
              </div>

              <div class="md:col-span-2">
                <label class="block text-sm font-medium text-gray-700 mb-1">Description</label>
                <textarea formControlName="description" rows="3"
                         class="w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
                         [ngClass]="{'border-red-500': isFieldInvalid('workExperiences.' + i + '.description')}"></textarea>
                <p *ngIf="isFieldInvalid('workExperiences.' + i + '.description')" class="mt-1 text-sm text-red-600">
                  {{getErrorMessage('workExperiences.' + i + '.description')}}
                </p>
              </div>
              
              <!-- Main Contributions -->
              <div class="md:col-span-2 mt-4">
                <label class="block text-sm font-medium text-gray-700 mb-1">Main Contributions</label>
                
                <div formArrayName="mainContributions" class="space-y-3">
                  <div class="flex flex-wrap gap-2 mb-3">
                    <div *ngFor="let contribution of getMainContributions(exp); let ci = index" 
                          class="px-3 py-1 bg-blue-50 text-blue-700 rounded-full text-sm flex items-center">
                      {{contribution}}
                      <button type="button" (click)="removeContribution(i, ci)" 
                              class="ml-2 text-blue-500 hover:text-blue-700">×</button>
                    </div>
                  </div>
                  
                  <div class="flex gap-2">
                    <input type="text" 
                           placeholder="Add a contribution..." 
                           #contributionInput
                           class="flex-1 px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
                           (keydown.enter)="addContribution(i, contributionInput.value, contributionInput); $event.preventDefault()">
                    <button type="button"
                            (click)="addContribution(i, contributionInput.value, contributionInput)"
                            class="px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700">
                      Add
                    </button>
                  </div>
                </div>
              </div>
              
              <!-- Tech Stack -->
              <div class="md:col-span-2 mt-4">
                <label class="block text-sm font-medium text-gray-700 mb-1">Tech Stack</label>
                
                <div formArrayName="techStack" class="space-y-3">
                  <div class="flex flex-wrap gap-2 mb-3">
                    <div *ngFor="let tech of getTechStack(exp); let ti = index" 
                          class="px-3 py-1 bg-green-50 text-green-700 rounded-full text-sm flex items-center">
                      {{tech}}
                      <button type="button" (click)="removeTechItem(i, ti)" 
                              class="ml-2 text-green-500 hover:text-green-700">×</button>
                    </div>
                  </div>
                  
                  <div class="flex gap-2">
                    <input type="text" 
                           placeholder="Add technology..." 
                           #techInput
                           class="flex-1 px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
                           (keydown.enter)="addTechItem(i, techInput.value, techInput); $event.preventDefault()">
                    <button type="button"
                            (click)="addTechItem(i, techInput.value, techInput)"
                            class="px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700">
                      Add
                    </button>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Education -->
      <div class="bg-white rounded-xl shadow-sm p-6">
        <div class="flex items-center justify-between mb-6">
          <h2 class="text-xl font-semibold text-gray-900">Education</h2>
          <button type="button" (click)="addEducation()"
                  class="px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 flex items-center">
            <span class="mr-2">+</span> Add Education
          </button>
        </div>

        <div formArrayName="education" class="space-y-6">
          <div *ngFor="let edu of educationArray.controls; let i = index" 
               [formGroupName]="i"
               class="p-6 bg-gray-50 rounded-lg border border-gray-200">
            <div class="flex justify-between items-center mb-4">
              <h3 class="text-lg font-medium text-gray-900">Education {{i + 1}}</h3>
              <button type="button" (click)="removeEducation(i)"
                      class="text-red-600 hover:text-red-700 p-1">
                <span class="text-xl">×</span>
              </button>
            </div>

            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
              <div>
                <label class="block text-sm font-medium text-gray-700 mb-1">Institution</label>
                <input type="text" formControlName="institution"
                       class="w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
                       [ngClass]="{'border-red-500': isFieldInvalid('education.' + i + '.institution')}">
                <p *ngIf="isFieldInvalid('education.' + i + '.institution')" class="mt-1 text-sm text-red-600">
                  Institution is required
                </p>
              </div>

              <div>
                <label class="block text-sm font-medium text-gray-700 mb-1">Degree</label>
                <input type="text" formControlName="degree"
                       class="w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
                       [ngClass]="{'border-red-500': isFieldInvalid('education.' + i + '.degree')}">
                <p *ngIf="isFieldInvalid('education.' + i + '.degree')" class="mt-1 text-sm text-red-600">
                  Degree is required
                </p>
              </div>

              <!-- Education Date Inputs -->
              <div>
                <app-month-year-picker
                  label="Start Date"
                  [yearRange]="'1980:2030'"
                  [invalid]="isFieldInvalid('education.' + i + '.startDate')"
                  [errorMessage]="'Start date is required'"
                  [dateValue]="edu.get('startDate')?.value"
                  (dateChange)="handleDateChange(edu.get('startDate'), $event)">
                </app-month-year-picker>
              </div>

              <div>
                <app-month-year-picker
                  label="End Date"
                  [yearRange]="'1980:2030'"
                  [invalid]="isFieldInvalid('education.' + i + '.endDate')"
                  [errorMessage]="'End date is required'"
                  [allowPresent]="true"
                  [dateValue]="edu.get('endDate')?.value"
                  (dateChange)="handleDateChange(edu.get('endDate'), $event)">
                </app-month-year-picker>
              </div>

              <div>
                <label class="block text-sm font-medium text-gray-700 mb-1">Thesis (Optional)</label>
                <input type="text" formControlName="thesis"
                       class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
              </div>

              <div>
                <label class="block text-sm font-medium text-gray-700 mb-1">Supervisor (Optional)</label>
                <input type="text" formControlName="supervisor"
                       class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Certifications -->
      <div class="bg-white rounded-xl shadow-sm p-6">
        <div class="flex items-center justify-between mb-6">
          <h2 class="text-xl font-semibold text-gray-900">Certifications</h2>
          <button type="button" (click)="addCertification()"
                  class="px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 flex items-center">
            <span class="mr-2">+</span> Add Certification
          </button>
        </div>

        <div formArrayName="certifications" class="space-y-6">
          <div *ngFor="let cert of certificationsArray.controls; let i = index" 
               [formGroupName]="i"
               class="p-6 bg-gray-50 rounded-lg border border-gray-200">
            <div class="flex justify-between items-center mb-4">
              <h3 class="text-lg font-medium text-gray-900">Certification {{i + 1}}</h3>
              <button type="button" (click)="removeCertification(i)"
                      class="text-red-600 hover:text-red-700 p-1">
                <span class="text-xl">×</span>
              </button>
            </div>

            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
              <div>
                <label class="block text-sm font-medium text-gray-700 mb-1">Certification Name</label>
                <input type="text" formControlName="certificationName"
                       class="w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
                       [ngClass]="{'border-red-500': isFieldInvalid('certifications.' + i + '.certificationName')}">
                <p *ngIf="isFieldInvalid('certifications.' + i + '.certificationName')" class="mt-1 text-sm text-red-600">
                  Certification name is required
                </p>
              </div>

              <div>
                <label class="block text-sm font-medium text-gray-700 mb-1">Institution</label>
                <input type="text" formControlName="institution"
                       class="w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
                       [ngClass]="{'border-red-500': isFieldInvalid('certifications.' + i + '.institution')}">
                <p *ngIf="isFieldInvalid('certifications.' + i + '.institution')" class="mt-1 text-sm text-red-600">
                  Institution is required
                </p>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Languages -->
      <div class="bg-white rounded-xl shadow-sm p-6">
        <div class="flex items-center justify-between mb-6">
          <h2 class="text-xl font-semibold text-gray-900">Languages</h2>
          <button type="button" (click)="addLanguage()"
                  class="px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 flex items-center">
            <span class="mr-2">+</span> Add Language
          </button>
        </div>

        <div formArrayName="languages" class="space-y-6">
          <div *ngFor="let lang of languagesArray.controls; let i = index" 
               [formGroupName]="i"
               class="p-6 bg-gray-50 rounded-lg border border-gray-200">
            <div class="flex justify-between items-center mb-4">
              <h3 class="text-lg font-medium text-gray-900">Language {{i + 1}}</h3>
              <button type="button" (click)="removeLanguage(i)"
                      class="text-red-600 hover:text-red-700 p-1">
                <span class="text-xl">×</span>
              </button>
            </div>

            <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
              <div>
                <label class="block text-sm font-medium text-gray-700 mb-1">Language</label>
                <input type="text" formControlName="name"
                       class="w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
                       [ngClass]="{'border-red-500': isFieldInvalid('languages.' + i + '.name')}">
                <p *ngIf="isFieldInvalid('languages.' + i + '.name')" class="mt-1 text-sm text-red-600">
                  Language name is required
                </p>
              </div>

              <div>
                <label class="block text-sm font-medium text-gray-700 mb-1">Institute</label>
                <input type="text" formControlName="institute"
                       class="w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
                       [ngClass]="{'border-red-500': isFieldInvalid('languages.' + i + '.institute')}">
                <p *ngIf="isFieldInvalid('languages.' + i + '.institute')" class="mt-1 text-sm text-red-600">
                  Institute is required
                </p>
              </div>

              <div>
                <label class="block text-sm font-medium text-gray-700 mb-1">Proficiency</label>
                <select formControlName="proficiency"
                       class="w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
                       [ngClass]="{'border-red-500': isFieldInvalid('languages.' + i + '.proficiency')}">
                  <option *ngFor="let option of languageProficiencyOptions" [value]="option.value">
                    {{ option.label }}
                  </option>
                </select>
                <p *ngIf="isFieldInvalid('languages.' + i + '.proficiency')" class="mt-1 text-sm text-red-600">
                  Please select a proficiency level
                </p>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Interests -->
      <div class="bg-white rounded-xl shadow-sm p-6">
        <div class="mb-6">
          <h2 class="text-xl font-semibold text-gray-900">Interests</h2>
        </div>
        
        <div formArrayName="interests" class="space-y-4">
          <div class="flex flex-wrap gap-2 mb-3">
            <span *ngFor="let interest of interestsArray.controls; let i = index" 
                  class="px-3 py-1 bg-blue-50 text-blue-700 rounded-full text-sm flex items-center">
              {{interest.value}}
              <button type="button" (click)="removeInterest(i)" 
                      class="ml-2 text-blue-500 hover:text-blue-700">×</button>
            </span>
          </div>
          <input type="text" placeholder="Add an interest..." #interestInput
                 (keydown.enter)="addInterest({value: interestInput.value, chipInput: interestInput}); interestInput.value = ''; $event.preventDefault()"
                 class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
        </div>
      </div>

      <!-- Submit Button -->
      <div class="flex justify-end">
        <button type="submit"
                class="px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 flex items-center font-medium">
          <span class="mr-2">Generate CV</span>
          <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor">
            <path fill-rule="evenodd" d="M6 2a2 2 0 00-2 2v12a2 2 0 002 2h8a2 2 0 002-2V7.414A2 2 0 0015.414 6L12 2.586A2 2 0 0010.586 2H6zm5 6a1 1 0 10-2 0v3.586L7.707 10.293a1 1 0 10-1.414 1.414l3 3a1 1 0 001.414 0l3-3a1 1 0 00-1.414-1.414L11 11.586V8z" clip-rule="evenodd" />
          </svg>
        </button>
      </div>
    </form>
  </div>
</div>
